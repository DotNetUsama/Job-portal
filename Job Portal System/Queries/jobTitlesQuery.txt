SELECT DISTINCT ?title ?id WHERE {
	{
		SELECT ?occupationType WHERE {
			?occupationType skos:broader dbc:Occupations_by_type .
			FILTER (?occupationType NOT IN (dbc:Illegal_occupations, dbc:Gendered_occupations, dbc:Indian_castes_by_profession))
		}
	}
	
	?occupation dct:subject ?occupationType .
	?occupation rdfs:label ?label .
	FILTER (langmatches(lang(?label),"en")) .
	BIND (str(?label) AS ?title) .
	?occupation dbo:wikiPageID ?wikiId .
	BIND (str(?wikiId) AS ?id) .
	FILTER (NOT EXISTS { ?occupation foaf:name [] . }) .
	FILTER (NOT EXISTS { ?occupation <http://purl.org/linguistics/gold/hypernym> dbr:list . }) .
} 